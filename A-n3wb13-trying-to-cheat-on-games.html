<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>A n3wb13 trying to cheat on games</title><meta name="description" content="That n3wb13 is me, and that post is a transcription of the talk I gave at RoadSec SP"><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">A n3wb13 trying to cheat on games</h1>
</header>
<section data-field="subtitle" class="p-summary">
That n3wb13 is me, and that post is a transcription of the talk I gave at RoadSec SP
</section>
<section data-field="body" class="e-content">
<section name="0978" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="9389" id="9389" class="graf graf--h3 graf--leading graf--title">A n3wb13 trying to cheat on games</h3><p name="cd50" id="cd50" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">That n3wb13 is me, and</em> <em class="markup--em markup--p-em">that post is a transcription of the talk I gave at RoadSec SP</em></p><p name="9d1e" id="9d1e" class="graf graf--p graf-after--p">[ Posted on 21 Nov 16 @ 18:59 ]</p></div><div class="section-inner sectionLayout--fullWidth"><figure name="ecf3" id="ecf3" class="graf graf--figure graf--layoutFillWidth graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 26.1%;"></div><img class="graf-image" data-image-id="0*YQdXCJwtYu1r_6ye.png" data-width="1400" data-height="365" src="https://cdn-images-1.medium.com/max/2000/0*YQdXCJwtYu1r_6ye.png"></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="979b" id="979b" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--figure"><span class="graf-dropCap">A</span>ll started with my girlfriend waving her phone at me and shouting “LOOK HOW I AM SOOOO GOOOD AT THIS”. “THIS” == 2048 , a puzzle game that became really famous a year and a half back.</p><figure name="d1b9" id="d1b9" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 885px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 126.4%;"></div><img class="graf-image" data-image-id="0*ZmGLViqqu9JCbpBW.jpg" data-width="731" data-height="924" src="https://cdn-images-1.medium.com/max/800/0*ZmGLViqqu9JCbpBW.jpg"></div></figure><p name="4492" id="4492" class="graf graf--p graf-after--figure">And so I grabbed my macbook and started to play, being sure that I was going to OWN her. And so I’ve failed miserably :’( Now I just want to fuck the game and get the highest score possible.</p><h3 name="74ae" id="74ae" class="graf graf--h3 graf-after--p">Memory editing</h3><p name="8cb0" id="8cb0" class="graf graf--p graf-after--h3">The first thing that came to my mind was that the score was in some place of the memory of the game, and probably I could overwrite it. Doing some research (googling arround) I stumbled upon a really wonderfull piece of open source software: <a href="https://github.com/zorgiepoo/Bit-Slicer" data-href="https://github.com/zorgiepoo/Bit-Slicer" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Bit Slicer</a>. It sells it self as “Universal game trainer for macOS”, exactly what I need.</p><figure name="a4ea" id="a4ea" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 537px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 76.7%;"></div><img class="graf-image" data-image-id="0*lQsCSnERZxHTIIt9.png" data-width="1400" data-height="1074" src="https://cdn-images-1.medium.com/max/800/0*lQsCSnERZxHTIIt9.png"></div></figure><p name="4330" id="4330" class="graf graf--p graf-after--figure">All you have to do is search for the value with the desired type, Int32 in my case. My score was 216 at the time :</p><figure name="05a5" id="05a5" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 536px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 76.6%;"></div><img class="graf-image" data-image-id="0*MVJMGuLBxyuZLdlJ.png" data-width="1400" data-height="1072" src="https://cdn-images-1.medium.com/max/800/0*MVJMGuLBxyuZLdlJ.png"></div></figure><p name="47c4" id="47c4" class="graf graf--p graf-after--figure">It found 1702 memory addresses that contain 216 as the value. That’s a lot, you need to narrow down your search, and to do so you have to change the value of the score playing a little bit , and searching within those first 1702 addresses which ones changed to your new score. In my case, my new score was 240 .</p><p name="2bbc" id="2bbc" class="graf graf--p graf-after--p">Now it just shows 2 addresses, nice.Maybe you’re asking why two and not just one, that’s probably because of some redundance as one for save the number as a Integer , and another to save the value of the String, something like that. Now I just have to edit those two to 1337.</p><figure name="cf10" id="cf10" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 536px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 76.5%;"></div><img class="graf-image" data-image-id="0*_SnDW9kshqyOPBo4.png" data-width="1400" data-height="1071" src="https://cdn-images-1.medium.com/max/800/0*_SnDW9kshqyOPBo4.png"></div></figure><p name="8ae8" id="8ae8" class="graf graf--p graf-after--figure">The game it did not changed the value, but if you do something in it , it will update the value.</p><figure name="3527" id="3527" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 638px; max-height: 1114px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 174.6%;"></div><img class="graf-image" data-image-id="0*Z_S2iOd3Q8anQ1BU.png" data-width="638" data-height="1114" src="https://cdn-images-1.medium.com/max/800/0*Z_S2iOd3Q8anQ1BU.png"></div></figure><p name="b5d5" id="b5d5" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Yeah , my BEST is really huge</em></p><p name="3dca" id="3dca" class="graf graf--p graf-after--p">NICE ! I showed my girlfriend and she was like “You just edited the memory right? <em class="markup--em markup--p-em">rolls eyes</em>” . But that was too easy :/</p><h3 name="6593" id="6593" class="graf graf--h3 graf-after--p">Editing the save</h3><p name="bf5b" id="bf5b" class="graf graf--p graf-after--h3">After that I realized that the game saves the last state when you close it, that made me try to find where it saves the state and edit it. Another round of Google showed me that the support files for all programs was in the <code class="markup--code markup--p-code">~/Library/Application Support/</code> directory. Unfortunately, the game wasn&#39;t there, nor the bundleId of it, <code class="markup--code markup--p-code">com.codinn.2048</code> that id is found at the <code class="markup--code markup--p-code">Info.plist</code> of the app. More of Google showed me that some Apps uses &quot;containers&quot; that is some sort of sandbox for the OS X apps, that resides at <code class="markup--code markup--p-code">~/Library/Containers/</code>. <br> There I found a dir with the bundleId of the game, and the plist that contains the game state : <code class="markup--code markup--p-code">~/Library/Containers/com.codinn.2048/Data/Library/Preferences/com.codinn.2048.plist</code>. Opening in Xcode :</p><figure name="017b" id="017b" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 90px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 12.9%;"></div><img class="graf-image" data-image-id="0*z_EY9hYplPfIOG7l.png" data-width="1400" data-height="180" src="https://cdn-images-1.medium.com/max/800/0*z_EY9hYplPfIOG7l.png"></div></figure><p name="df74" id="df74" class="graf graf--p graf-after--figure">The value of “gameState” is :</p><pre name="f730" id="f730" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">{&quot;grid&quot;:{&quot;size&quot;:4,&quot;cells&quot;:[[{&quot;position&quot;:{&quot;x&quot;:0,&quot;y&quot;:0},&quot;value&quot;:4},{&quot;position&quot;:{&quot;x&quot;:0,&quot;y&quot;:1},&quot;value&quot;:8},{&quot;position&quot;:{&quot;x&quot;:0,&quot;y&quot;:2},&quot;value&quot;:32},{&quot;position&quot;:{&quot;x&quot;:0,&quot;y&quot;:3},&quot;value&quot;:8}],[{&quot;position&quot;:{&quot;x&quot;:1,&quot;y&quot;:0},&quot;value&quot;:8},{&quot;position&quot;:{&quot;x&quot;:1,&quot;y&quot;:1},&quot;value&quot;:16},{&quot;position&quot;:{&quot;x&quot;:1,&quot;y&quot;:2},&quot;value&quot;:2},{&quot;position&quot;:{&quot;x&quot;:1,&quot;y&quot;:3},&quot;value&quot;:4}],[{&quot;position&quot;:{&quot;x&quot;:2,&quot;y&quot;:0},&quot;value&quot;:2},{&quot;position&quot;:{&quot;x&quot;:2,&quot;y&quot;:1},&quot;value&quot;:8},null,{&quot;position&quot;:{&quot;x&quot;:2,&quot;y&quot;:3},&quot;value&quot;:2}],[{&quot;position&quot;:{&quot;x&quot;:3,&quot;y&quot;:0},&quot;value&quot;:4},{&quot;position&quot;:{&quot;x&quot;:3,&quot;y&quot;:1},&quot;value&quot;:2},null,{&quot;position&quot;:{&quot;x&quot;:3,&quot;y&quot;:3},&quot;value&quot;:2}]]},&quot;score&quot;:1337,&quot;over&quot;:false,&quot;won&quot;:false,&quot;keepPlaying&quot;:false}</code></pre><p name="34ef" id="34ef" class="graf graf--p graf-after--pre">It’s nothing more than a json with the values and the positions of the tiles. So I just edit this and Voila, right? No :/ For some reason , probably because the app is sandboxed , even if I edit this , the gameState is not going to change . I’m sure that must be a way to bypass and edit this, I will try in the future.</p><h3 name="2d53" id="2d53" class="graf graf--h3 graf-after--p">Reversing and editing the game</h3><p name="a879" id="a879" class="graf graf--p graf-after--h3">So , what now ? Errrrrr , I could edit the binary of the game to make more points and so on. Let’s do that !</p><p name="7e21" id="7e21" class="graf graf--p graf-after--p">First let’s open this on radare2 — No , I’m not trying to show off not using a GUI tool , r2 is free and opensource, and I’m just a student who doesn’t have money to buy IDA Pro or Hopper.</p><pre name="e54f" id="e54f" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ sudo r2 -w /Applications/2048+.app/Contents/MacOS/2048+ Password: arw 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020160000010000000000000000000000000000000000000000000000000000000000000000000000 -- You see it, you fix it! [0x100001620]&gt;</code></pre><p name="0768" id="0768" class="graf graf--p graf-after--pre">The <code class="markup--code markup--p-code">-w</code> is for writing. First thing you want to do is <code class="markup--code markup--p-code">aaa</code> to analyse all the functions and name then. The r2 has a really cool way to name the commands, it&#39;s just the first letters of the description, the first <code class="markup--code markup--p-code">a</code> is for &quot;analyse&quot;, the second is for &quot;all&quot; , and the third is for &quot;autoname&quot; . r2 also has a really helpfull help (pun not intended) interface, just put a question mark after the command and it will show all the adjacents, something like that :</p><figure name="fc07" id="fc07" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 305px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.5%;"></div><img class="graf-image" data-image-id="0*yepZay9IO0I49lau.png" data-width="1400" data-height="609" src="https://cdn-images-1.medium.com/max/800/0*yepZay9IO0I49lau.png"></div></figure><p name="e77a" id="e77a" class="graf graf--p graf-after--figure">So , after run <code class="markup--code markup--p-code">aaa</code> , you want to list all the functions . Just run <code class="markup--code markup--p-code">afl</code> and it will show a ton of functions, if you put a <code class="markup--code markup--p-code">~</code> after the command it will grep it. I wanted to search for the beginning of the binary, and so I did <code class="markup--code markup--p-code">afl~main</code>; <code class="markup--code markup--p-code">afl~entrypoint</code> ; <code class="markup--code markup--p-code">afl~begin</code> ; <code class="markup--code markup--p-code">afl~start</code> , and nothing ( Note that this is case sensitive ).</p><p name="cb82" id="cb82" class="graf graf--p graf-after--p">I came back to basics, and did a <code class="markup--code markup--p-code">strings</code> at the binary , something really made me &quot;WTF?&quot; : it showed a lot of <code class="markup--code markup--p-code">webView</code> strings. So , yeah , that shit is just a web application --&#39;</p><p name="19f5" id="19f5" class="graf graf--p graf-after--p">After that shitty realization , I just open the “Resources” dir in the app , and it was all the html/js/css of the app, really frustating .</p><pre name="b43d" id="b43d" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ ls<br>CONTRIBUTING.md README.md index.html sound LICENSE.txt fontello js style</code></pre><p name="3463" id="3463" class="graf graf--p graf-after--pre">That’s really easy to edit. <br> In the line 188 of the file <code class="markup--code markup--p-code">Resources/2048/js/game_manager.js</code> it&#39;s where the game calculate the new value when two tiles merges, it just multiply the previous value for 2.</p><pre name="940f" id="940f" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">var merged = new Tile(positions.next, tile.value * 2);</code></pre><p name="74c8" id="74c8" class="graf graf--p graf-after--pre">So , just change the 2 to , let’s say , 9999 . And that’s beautifull .</p><figure name="dfd0" id="dfd0" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 598px; max-height: 1080px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 180.6%;"></div><img class="graf-image" data-image-id="0*uws5CnpdR0MX9hAw.png" data-width="598" data-height="1080" src="https://cdn-images-1.medium.com/max/800/0*uws5CnpdR0MX9hAw.png"></div></figure><p name="797e" id="797e" class="graf graf--p graf-after--figure">All easy , all great. But was really fun. And now I’m the first of the global rank ^^</p><figure name="6c37" id="6c37" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 846px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 120.9%;"></div><img class="graf-image" data-image-id="0*gUWjLHE1pLhaDV88.png" data-width="940" data-height="1136" src="https://cdn-images-1.medium.com/max/800/0*gUWjLHE1pLhaDV88.png"></div></figure><h3 name="bc74" id="bc74" class="graf graf--h3 graf-after--figure">Faster Than Light</h3><p name="2876" id="2876" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--h3"><span class="graf-dropCap">F</span>TL is a indie game , rouge-like , with spaceships and battles ‘n shit . Lots of fun , but really hard ( I’ve never beaten the last boss ) . So , let’s hack the shit out of it .</p><h4 name="2754" id="2754" class="graf graf--h4 graf-after--p">Memory, bleh</h4><p name="5c22" id="5c22" class="graf graf--p graf-after--h4">I’ve started with the same memory editing we did at 2048+ . You really can edit all the variables, your life , the enemy’s life , the money , etc . The same procedure , the same results , bleh .</p><figure name="f3c5" id="f3c5" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 438px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 62.5%;"></div><img class="graf-image" data-image-id="0*4p0jDZv9d7WyRlB_.png" data-width="1280" data-height="800" src="https://cdn-images-1.medium.com/max/800/0*4p0jDZv9d7WyRlB_.png"></div></figure><p name="75c9" id="75c9" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Note those numbers not fitting the boxes</em></p><h4 name="27bd" id="27bd" class="graf graf--h4 graf-after--p">Editing the save</h4><p name="d428" id="d428" class="graf graf--p graf-after--h4">But the game is more complex, so you have to constantly edit your life , you can’t edit your damage (because you don’t know what to search), and that’s boring.</p><p name="8823" id="8823" class="graf graf--p graf-after--p">First thing I tried was to edit the save game, because I failed in the last game. The save game is at <code class="markup--code markup--p-code">~/Library/Application Support/fasterthanlight</code> , not in the <code class="markup--code markup--p-code">Containers</code>, so no sandbox, nice . The files :</p><pre name="9ed4" id="9ed4" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ ls<br>ae_prof.sav continue.sav prof.sav settings.ini</code></pre><p name="58a6" id="58a6" class="graf graf--p graf-after--pre"><code class="markup--code markup--p-code">settings.ini</code> is just a txt with the configurations of the game, sound , fullscreen, etc. The .sav ones is the saves/stats/achievements. So , wtf is that ?</p><pre name="bf52" id="bf52" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">$ file continue.sav<br>continue.sav: data<br>$ xxd continue.sav 0000000: 0900 0000 0000 0000 0100 0000 0100 0000 ................ 0000010: 0400 0000 1600 0000 0300 0000 0b00 0000 ................ 0000020: 5468 6520 4b65 7374 7265 6c10 0000 0050 The Kestrel....P 0000030: 4c41 5945 525f 5348 4950 5f48 4152 4401 LAYER_SHIP_HARD. 0000040: 0000 0000 0000 0003 0000 000a 0000 0066 ...............f 0000050: 6972 6564 5f73 686f 7405 0000 0006 0000 ired_shot....... 0000060: 0068 6967 686f 3201 0000 000c 0000 0075 .higho2........u 0000070: 7365 645f 6d69 7373 696c 6502 0000 0010 sed_missile..... 0000080: 0000 0050 4c41 5945 525f 5348 4950 5f48 ...PLAYER_SHIP_H 0000090: 4152 440b 0000 0054 6865 204b 6573 7472 ARD....The Kestr 00000a0: 656c 0700 0000 6b65 7374 7261 6c03 0000 el....kestral... 00000b0: 0005 0000 0068 756d 616e 0700 0000 4359 .....human....CY 00000c0: 2048 656e 6705 0000 0068 756d 616e 0600 Heng....human.. 00000d0: 0000 4772 6163 6965 0500 0000 6875 6d61 ..Gracie....huma 00000e0: 6e06 0000 0041 7472 6579 7501 0000 00c2 n....Atreyu..... ... ETC</code></pre><p name="5a25" id="5a25" class="graf graf--p graf-after--pre">That is a proprietary file format , so I have to try to understand where is the values I want to edit. I’ve used the HexFiend app , which is a hex editor for Mac , also open source , in fact Bit Slicer uses some part of their code.</p><p name="b216" id="b216" class="graf graf--p graf-after--p">First I want to edit how much scrap I have ( which is the money of the game ) . If I was doing that with the BitSlicer , I would have to be able to change the value to narrow down the research. <br> My money at the time was 10 , which in hexa is <code class="markup--code markup--p-code">0xa</code>, so just search:</p><figure name="bc45" id="bc45" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 473px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 67.60000000000001%;"></div><img class="graf-image" data-image-id="0*bp_jA9oVBuODf0Q0.png" data-width="1400" data-height="946" src="https://cdn-images-1.medium.com/max/800/0*bp_jA9oVBuODf0Q0.png"></div></figure><p name="02dd" id="02dd" class="graf graf--p graf-after--figure"><code class="markup--code markup--p-code">0xa</code> is a shit value because it appears a lot , not as much as in the memory , but a lot . In the beginning of the file it has some information that matches with my ship, like the name , the crew , so I presume that the first <code class="markup--code markup--p-code">0A</code> is the money ( yeah , I&#39;m a guessing knight ) . Just edit the first appearance to <code class="markup--code markup--p-code">FFFF</code> ( 65535 ) , save it , and BANG!</p><figure name="f94d" id="f94d" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 262px; max-height: 92px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 35.099999999999994%;"></div><img class="graf-image" data-image-id="0*wlXUqYSvJ98QGYlf.png" data-width="262" data-height="92" src="https://cdn-images-1.medium.com/max/800/0*wlXUqYSvJ98QGYlf.png"></div></figure><p name="d60a" id="d60a" class="graf graf--p graf-after--figure">Oh! Another guess was the file <code class="markup--code markup--p-code">continue.sav</code> , the other ones have other states of the game , score , achievements . I could do a reverse in the binary to find more values , and be more precise , but that would take days .</p><h4 name="40ea" id="40ea" class="graf graf--h4 graf-after--p">Reversing the binary</h4><p name="42f1" id="42f1" class="graf graf--p graf-after--h4">The other thing I wanted to do was to be invencible without the need to edit the memory by hand all the time . r2 time !</p><p name="9a62" id="9a62" class="graf graf--p graf-after--p">The binary of the game is at <code class="markup--code markup--p-code">/Library/Application Support/Steam/steamapps/common/FTL Faster Than Light/FTL.app/Contents/MacOS/FTL</code> because it it&#39;s on the Steam. First I&#39;ve checked if it was a WebApp , and it wasn&#39;t :&#39;(</p><p name="3755" id="3755" class="graf graf--p graf-after--p">Running on the r2 and analysing all the functions take some time, and after that I started to look with functions that had something with “Damage”</p><pre name="09ac" id="09ac" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">[0x1000f9959]&gt; afl~Damage 0x100018382 1 8 sym.Collideable::DamageBeam 0x10001838a 1 8 sym.Collideable::DamageArea 0x100018392 1 8 sym.Collideable::DamageShield 0x1000183bc 1 6 sym.Targetable::DamageTarget 0x1000184f2 1 60 sym.Projectile::SetDamage 0x10001a9b8 3 168 sym.IonDrone::GetRoomDamage 0x10001b778 3 35 sym.CrewDrone::ShipDamage 0x10001cb80 1 14 sym.CrewMember::GetDamageMultiplier 0x10001cbe2 1 83 sym.CrewMember::GetRoomDamage 0x10001ce52 1 14 sym.BoarderDrone::GetDamageMultiplier ... ETC ... ETC</code></pre><p name="0f26" id="0f26" class="graf graf--p graf-after--pre">After some hours analysing the functions, all of them or really did nothing special, or I was unable to edit because of some really weird instructions, like :</p><figure name="480d" id="480d" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 120px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 17.2%;"></div><img class="graf-image" data-image-id="0*N2m4QgwsnSR085GP.jpg" data-width="710" data-height="122" src="https://cdn-images-1.medium.com/max/800/0*N2m4QgwsnSR085GP.jpg"></div></figure><p name="7e40" id="7e40" class="graf graf--p graf-after--figure">Really , I have no idea what those instructions do,and I’ve searched, it’s something with double/float types I think . <br> So I had a idea, the ship is able to dodge missiles and shoots, it has to be a function that calculates that.</p><pre name="dec7" id="dec7" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">[0x1000f8104]&gt; afl~Dodge 0x10001839a 1 8 sym.Collideable::GetDodged 0x1000f8828 19 340 sym.ShipManager::GetDodgeFactor 0x1000f9906 1 47 sym.ShipManager::GetNetDodgeFactor 0x1000f9935 1 18 sym.non_virtualthunktoShipManager::GetDodged__ 0x1000f9948 20 396 sym.ShipManager::GetDodged 0x100112c18 2 27 sym.ShipSystem::GetEngineDodgeFactor 0x1001137d0 8 159 -&gt; 105 sym.EngineSystem::GetDodgeFactor</code></pre><p name="769e" id="769e" class="graf graf--p graf-after--pre">And looking at <code class="markup--code markup--p-code">sym.ShipManager::GetDodged</code> :</p><pre name="fdd0" id="fdd0" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">[0x1000f8104]&gt; s sym.ShipManager::GetDodged [0x1000f9948]&gt; VV</code></pre><p name="f77e" id="f77e" class="graf graf--p graf-after--pre"><code class="markup--code markup--p-code">s</code> stands for &quot;seek&quot; , and <code class="markup--code markup--p-code">VV</code> is for enter the visual mode. <code class="markup--code markup--p-code">p</code> in visual mode change the type of the visualization .</p><figure name="2ef9" id="2ef9" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 410px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 58.599999999999994%;"></div><img class="graf-image" data-image-id="0*tMqI5PIy8syhNrIE.png" data-width="1400" data-height="820" src="https://cdn-images-1.medium.com/max/800/0*tMqI5PIy8syhNrIE.png"></div></figure><p name="5cd1" id="5cd1" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">Beginning of the function</em></p><figure name="ee79" id="ee79" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 352px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 50.3%;"></div><img class="graf-image" data-image-id="0*rpHMUVbx2ADpMrxC.png" data-width="1400" data-height="704" src="https://cdn-images-1.medium.com/max/800/0*rpHMUVbx2ADpMrxC.png"></div></figure><p name="85ed" id="85ed" class="graf graf--p graf-after--figure"><em class="markup--em markup--p-em">End of the function</em></p><p name="e7fd" id="e7fd" class="graf graf--p graf-after--p">At the end ( second print ) , in <code class="markup--code markup--p-code">0x1000f9ac6</code> it just move the register <code class="markup--code markup--p-code">bl</code> to the <code class="markup--code markup--p-code">eax</code> and return it, so <code class="markup--code markup--p-code">bl</code> must be the register that holds if the ship was able to dodge or not . And in the <code class="markup--code markup--p-code">0x1000f995b</code> ( first print ) it moves 1 to <code class="markup--code markup--p-code">bl</code> and jumps to the end of the function . Now, the first jump <code class="markup--code markup--p-code">0x1000f9959</code> is a <code class="markup--code markup--p-code">jne</code> ( Jump Not Equal ) , which check if the last cmp <code class="markup--code markup--p-code">0x1000f995</code> was successful , if it was jumps to <code class="markup--code markup--p-code">0x1000f9962</code> , if not just continues the execution . Well , the chain of execution which leads to <code class="markup--code markup--p-code">0x1000f9962</code> it&#39;s really confusing and it does a lot of compares and checks to determine if it will mov 1 or 0 to <code class="markup--code markup--p-code">bl</code> , so I just want to the function return 1 , and always dodge . Editing the <code class="markup--code markup--p-code">0x1000f9959</code> and puting a <code class="markup--code markup--p-code">nop</code> ( instruction that does nothing ) instead of the <code class="markup--code markup--p-code">jne</code> , it will result to the function always mov 1 to <code class="markup--code markup--p-code">bl</code> and <code class="markup--code markup--p-code">jmp</code> to the finish . Let&#39;s do that :</p><pre name="25de" id="25de" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">[0x1000f9948]&gt; s 0x1000f9959 [0x1000f9959]&gt; wa nop Written 1 bytes (nop) = wx 90</code></pre><p name="9bf4" id="9bf4" class="graf graf--p graf-after--pre">Resulting in :</p><figure name="c4f9" id="c4f9" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 456px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 65.10000000000001%;"></div><img class="graf-image" data-image-id="0*YKEzVahsKrRbDeb1.png" data-width="832" data-height="542" src="https://cdn-images-1.medium.com/max/800/0*YKEzVahsKrRbDeb1.png"></div></figure><p name="5865" id="5865" class="graf graf--p graf-after--figure">Now , if you look at <code class="markup--code markup--p-code">0x1000f995a</code> , it shows &quot;invalid&quot; , because the <code class="markup--code markup--p-code">90</code> which is the <code class="markup--code markup--p-code">nop</code> hexadecimal representation did not overwrite all the <code class="markup--code markup--p-code">jne</code> hexa <code class="markup--code markup--p-code">7507</code> . Let&#39;s just put a <code class="markup--code markup--p-code">nop</code> at the remaining and it&#39;s all good , probably there is a better way to do , but fuck it .</p><pre name="84ff" id="84ff" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code">[0x1000f995b]&gt; s 0x1000f995a [0x1000f995a]&gt; wa nop</code></pre><figure name="3344" id="3344" class="graf graf--figure graf-after--pre"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 462px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66%;"></div><img class="graf-image" data-image-id="0*S4H7d72h3y7GH5nt.png" data-width="824" data-height="544" src="https://cdn-images-1.medium.com/max/800/0*S4H7d72h3y7GH5nt.png"></div></figure><p name="f8bf" id="f8bf" class="graf graf--p graf-after--figure">Now it will always dodge things , nice ! SUPER NINJA MODE (: You can edit anything you want in the game, but that was the simplest way I’ve found to become invincible .</p><h3 name="efe8" id="efe8" class="graf graf--h3 graf-after--p">Scripting</h3><p name="0fe5" id="0fe5" class="graf graf--p graf-after--h3">Another way of beating the game is dealing TONS OF DAMAGE, but edit the assembly is hard, and editing the memory is not. But how to make things easier ? Well , the BitSlicer has a bultin Python Library to Scripting , yaaaaay !</p><p name="833b" id="833b" class="graf graf--p graf-after--p">First thing is to find the memory address of the enemy’s life. Do the same search and when you find the address right click in it and “Watch Write Accesses” , now every time some instruction writes in that address we will see. Unpause the game and attack your enemy, and pause again to see that two instructions writed in that enemy’s life address,add those two to the list. One instruction have hundreds of writes and another just the times you attacked, open the one with less writes on the debugger and see that the Symbol points to <code class="markup--code markup--p-code">Ship::ProjectileStrike(int,float)</code>, that&#39;s the function that does damage.</p><p name="cf6a" id="cf6a" class="graf graf--p graf-after--p">Now analysing the assembly : <code class="markup--code markup--p-code">mov [rdi+0x70], eax</code> . <code class="markup--code markup--p-code">[rdi+0x70]</code> is the register that holds the enemy&#39;s life and the one we want to edit it is stored at <code class="markup--code markup--p-code">0xD642</code>, that value doens&#39;t change , so I&#39;ve made that script :</p><figure name="4346" id="4346" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/caioluders/89a7a95189a581e8d9bd557c1b9427d8.js"></script></figure><p name="1f04" id="1f04" class="graf graf--p graf-after--figure">It’s all commented, add that to the BitSlicer, make some damage in the enemy to get the address of his life and <code class="markup--code markup--p-code">cntrl+a</code> to kill it ˆ-ˆ</p><p name="1df7" id="1df7" class="graf graf--p graf-after--p">That sums up all the ways to cheat in a offline game, I’m doing some research at online games and reversing their protocol, but that will take time.</p><p name="929f" id="929f" class="graf graf--p graf-after--p graf--trailing">ty !</p></div></div></section><section name="241f" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="bc5d" id="bc5d" class="graf graf--p graf--leading graf--trailing"><em class="markup--em markup--p-em">Originally published at </em><a href="http://52.14.59.149/a-n3wb13-trying-to-cheat-on-games/" data-href="http://52.14.59.149/a-n3wb13-trying-to-cheat-on-games/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"><em class="markup--em markup--p-em">lude.rs</em></a><em class="markup--em markup--p-em"> on November 21, 2016.</em></p></div></div></section>
</section>
<footer><p class="p-tags">Tagged in <a href="https://medium.com/tag/javascript" class="p-tag">JavaScript</a>, <a href="https://medium.com/tag/hacking" class="p-tag">Hacking</a>, <a href="https://medium.com/tag/cheating" class="p-tag">Cheating</a>, <a href="https://medium.com/tag/roadsec" class="p-tag">Roadsec</a>, <a href="https://medium.com/tag/games" class="p-tag">Games</a></p><p>By <a href="https://medium.com/@caioluders" class="p-author h-card">Caio Lüders</a> on <a href="https://medium.com/p/6ec049f18cc8"><time class="dt-published" datetime="2016-11-21T18:59:18.000Z">November 21, 2016</time></a>.</p><p><a href="https://medium.com/@caioluders/a-n3wb13-trying-to-cheat-on-games-6ec049f18cc8" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on April 24, 2018.</p></footer></article>

</body></html>